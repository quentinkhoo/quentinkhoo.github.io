<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TISC 2022 Level 3 - PATIENT0 | Quentin</title><meta name=keywords content="ctf,tisc-2022,forensics,crc32,bruteforce,autopsy,hash-collision,ntfs,bios-parameter-block,ads,truecrypt"><meta name=description content="Leaky Matrices Challenge Description This was a forensics challenge unlocked at level 3 that was part of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular forensics challenge."><meta name=author content="Quentin Khoo"><link rel=canonical href=https://quentinkhoo.github.io/posts/tisc-2022-level3-patient0/><link crossorigin=anonymous href=/assets/css/stylesheet.993f9097e8d870439c2a9670fc4104ef9ca11ba29707a5a8cb5095b67a2ae128.css integrity="sha256-mT+Ql+jYcEOcKpZw/EEE75yhG6KXB6Woy1CVtnoq4Sg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://quentinkhoo.github.io/images/peepoclap.gif><link rel=icon type=image/png sizes=16x16 href=https://quentinkhoo.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://quentinkhoo.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://quentinkhoo.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://quentinkhoo.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="TISC 2022 Level 3 - PATIENT0"><meta property="og:description" content="Leaky Matrices Challenge Description This was a forensics challenge unlocked at level 3 that was part of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular forensics challenge."><meta property="og:type" content="article"><meta property="og:url" content="https://quentinkhoo.github.io/posts/tisc-2022-level3-patient0/"><meta property="og:image" content="https://quentinkhoo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-12T00:03:00+08:00"><meta property="article:modified_time" content="2022-09-12T00:03:00+08:00"><meta property="og:site_name" content="Quentin"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://quentinkhoo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="TISC 2022 Level 3 - PATIENT0"><meta name=twitter:description content="Leaky Matrices Challenge Description This was a forensics challenge unlocked at level 3 that was part of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular forensics challenge."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://quentinkhoo.github.io/posts/"},{"@type":"ListItem","position":3,"name":"TISC 2022 Level 3 - PATIENT0","item":"https://quentinkhoo.github.io/posts/tisc-2022-level3-patient0/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TISC 2022 Level 3 - PATIENT0","name":"TISC 2022 Level 3 - PATIENT0","description":"Leaky Matrices Challenge Description This was a forensics challenge unlocked at level 3 that was part of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular forensics challenge.","keywords":["ctf","tisc-2022","forensics","crc32","bruteforce","autopsy","hash-collision","ntfs","bios-parameter-block","ads","truecrypt"],"articleBody":"Leaky Matrices Challenge Description This was a forensics challenge unlocked at level 3 that was part of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular forensics challenge.\nPart 1 1 2 3 4 5 6 DESCRIPTION Topic: Forensics Palindrome has spread some virus to corrupt machines causing incorrect readings in patients' health measurements and rending them unusable. Inspect the file and see if you can uncover the 8 corrupted bytes that renders the file system unusable? Submit your flag in this format: TISC{last 4 bytes in 8 lowercase hex characters} In the process of solving Part 1, I definitely jumped the gun and enumerated the file much more than necessary to solve the first part. Right off the bat I went straight into analyzing what kind of file it was with our trusty file command:\nEnumerating the Provided File 1 2 └─$ file PATIENT0 PATIENT0: DOS/MBR boot sector, code offset 0x52+2, OEM-ID \"NTFS \", sectors/cluster 8, Media descriptor 0xf8, sectors/track 0, FAT (1Y bit by descriptor); NTFS, physical drive 0xab3566f7, sectors 12287, $MFT start cluster 4, $MFTMirror start cluster 767, bytes/RecordSegment 2^(-1*246), clusters/index block 1, serial number 05c66c6b160cddda1 We can see from this that the provided PATIENT0 file is an NTFS partition.\nLet’s go ahead and run fls on this to see what files are available on it:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 └─$ fls PATIENT0 r/r 4-128-1: $AttrDef r/r 8-128-2: $BadClus r/r 8-128-1: $BadClus:$Bad r/r 6-128-1: $Bitmap r/r 7-128-1: $Boot d/d 11-144-2: $Extend r/r 2-128-1: $LogFile r/r 0-128-1: $MFT r/r 1-128-1: $MFTMirr r/r 9-128-2: $Secure:$SDS r/r 9-144-7: $Secure:$SDH r/r 9-144-4: $Secure:$SII r/r 10-128-1: $UpCase r/r 10-128-2: $UpCase:$Info r/r 3-128-3: $Volume r/r 31-128-1: message.png r/r 31-128-3: message.png:$RAND -/r * 32-128-1: broken.pdf V/V 256: $OrphanFiles Hmmm, 3 interesting files found:\nbroken.pdf message.png message.png:$RAND NTFS and Bios Parameter Block Let’s focus on the broken.pdf first. Opening up we see the following:\nHmmm, looks like BPB is a clue. After some googling, turns out BPB stands for BIOS Parameter Block. The following tables (referenced from here) describes the data fields and its respective offset:\nByte Offset Field Length Field Name 0x00 3 bytes Jump Instruction 0x03 LONGLONG OEM ID 0x0B 25 bytes BPB 0x24 48 bytes Extended BPB 0x54 426 bytes Bootstrap Code 0x01FE WORD End of Sector Marker Ahhh we can see the BPB and Extended BPB starts at 0x0B and 0x24 respectively, spanning from 0x0B - 0x53. Let’s take a look at this range of bytes and what do they mean:\nByte Offset Field Length Sample Value Field Name 0x0B WORD 0x0002 Bytes Per Sector 0x0D BYTE 0x08 Sectors Per Cluster 0x0E WORD 0x0000 Reserved Sectors 0x10 3 BYTES 0x000000 always 0 0x13 WORD 0x0000 not used by NTFS 0x15 BYTE 0xF8 Media Descriptor 0x16 WORD 0x0000 always 0 0x18 WORD 0x3F00 Sectors Per Track 0x1A WORD 0xFF00 Number Of Heads 0x1C DWORD 0x3F000000 Hidden Sectors 0x20 DWORD 0x00000000 not used by NTFS 0x24 DWORD 0x80008000 not used by NTFS 0x28 LONGLONG 0x4AF57F0000000000 Total Sectors 0x30 LONGLONG 0x0400000000000000 Logical Cluster Number for the file $MFT 0x38 LONGLONG 0x54FF070000000000 Logical Cluster Number for the file $MFTMirr 0x40 DWORD 0xF6000000 Clusters Per File Record Segment 0x44 BYTE 0x01 Clusters Per Index Buffer 0x45 3 BYTES 0x000000 not used by NTFS 0x48 LONGLONG 0x14A51B74C91B741C Volume Serial Number 0x50 DWORD 0x00000000 Checksum Hmm, seems like there’s an 8 bytes worth of data not used by NTFS from 0x20 - 0x27. Let’s investigate this piece of data in a hex editor:\n1 2 3 4 00000000 EB 52 90 4E 54 46 53 20 20 20 20 00 02 08 00 00 .R.NTFS ..... 00000010 00 00 00 00 00 F8 00 00 00 00 00 00 00 00 00 00 ................ 00000020 54 49 53 43 F7 66 35 AB FF 2F 00 00 00 00 00 00 TISC.f5../...... 00000030 04 00 00 00 00 00 00 00 FF 02 00 00 00 00 00 00 ................ Hmmmm, we have some TISC string, and the challenge description tells us to use the last 4 bytes (f76635ab) from the corrupted 8 bytes, giving us the flag TISC{f76635ab}.\nPart 2 1 2 3 4 5 6 7 8 DESCRIPTION Topic: Forensics Palindrome must have leaked one of their passwords as the 4 corrupted bytes (Part 1 flag)! Dig deeper to find what was hidden! Submit your flag in this format: TISC{md5 hash} \u003c-- will be prompted only after opening hidden room. Note: Please ignore the word 'original' in clue 4. NTFS Alternate Data Streams (ADS) Hmm, no additional file(s). Let’s go back to looking at our results from our fls command, in particular the other 2 files that were seemingly interesting.\n1 2 r/r 31-128-1: message.png r/r 31-128-3: message.png:$RAND It seems like we have an Alternate Data Stream hidden within the message.png file. An Alternate Data Stream (ADS) is exclusive to an NTFS formatted file system. It is basically another way of hiding a file within a file (although the hidden file is not exactly WITHIN the facade file, it’s just forked into another stream, hence the name Alternate Data Stream).\nLet’s extract both files message.png and the ADS to it with icat. icat allows us to essentially output file contents based on an inode number, which is essentially the second column of data from the fls output.\n1 2 3 └─$ icat PATIENT0 31-128-1 \u003e\u003e message.png └─$ file message.png message.png: PNG image data, 1227 x 57, 8-bit/color RGB, non-interlaced Opening up the image we get a base32 encoded text in an image. We can recognise it’s base32 from the fact that the letters are all in uppercase.\nI used an online tool to extract the string out for decoding and with that, I got the next clue!\n1 2 └─$ echo \"GIXFI2DJOJZXI6JAMZXXEIDUNBSSAZTMMFTT6ICHN4QGM2LOMQQHI2DFEBZXI4TFMFWS4CQ=\" | base32 -d 130 ⨯ 2.Thirsty for the flag? Go find the stream. Okay, turns out it wasn’t so much of a clue for me since I recognised the presence of the ADS already, this clue just confirms it :p\nso let’s go ahead and extract the ADS and analyze it!\n1 2 3 └─$ icat PATIENT0 31-128-3 \u003e\u003e message.bin └─$ file message.bin message.bin: data Encrypted Volumes Hmmm, a data file. Let’s open it up in a hex editor and see what’s up.\n1 2 3 4 5 File: message.bin ASCII Offset: 0x00000000 / 0x004001F1 (%00) 00000000 33 2E 41 72 65 20 74 68 65 73 65 20 54 72 75 65 3.Are these True 00000010 20 72 61 6E 64 6F 6D 20 62 79 74 65 73 20 66 6F random bytes fo 00000020 72 20 43 72 79 70 74 6F 6C 6F 67 79 3F 4B 76 18 r Cryptology?Kv. 00000030 7A 66 97 EB 45 D8 24 D0 DC 51 7E 42 8D 5A 18 3A zf..E.$..Q~B.Z.: Hmmm, looks like the header of the file gives us our next clue. We also have the 4th clue at the end of the file.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 00400120 C1 C5 E1 AB B3 9B 34 00 2E 00 49 00 66 00 20 00 ......4...I.f. . 00400130 79 00 6F 00 75 00 20 00 6E 00 65 00 65 00 64 00 y.o.u. .n.e.e.d. 00400140 20 00 61 00 20 00 70 00 61 00 73 00 73 00 77 00 .a. .p.a.s.s.w. 00400150 6F 00 72 00 64 00 2C 00 20 00 74 00 68 00 65 00 o.r.d.,. .t.h.e. 00400160 20 00 6F 00 72 00 69 00 67 00 69 00 6E 00 61 00 .o.r.i.g.i.n.a. 00400170 6C 00 20 00 72 00 65 00 61 00 64 00 69 00 6E 00 l. .r.e.a.d.i.n. 00400180 67 00 20 00 6F 00 66 00 20 00 74 00 68 00 65 00 g. .o.f. .t.h.e. 00400190 20 00 42 00 50 00 42 00 20 00 77 00 61 00 73 00 .B.P.B. .w.a.s. 004001A0 20 00 61 00 63 00 74 00 75 00 61 00 6C 00 6C 00 .a.c.t.u.a.l.l. 004001B0 79 00 20 00 43 00 68 00 65 00 63 00 6B 00 65 00 y. .C.h.e.c.k.e. 004001C0 64 00 20 00 61 00 6E 00 64 00 20 00 52 00 65 00 d. .a.n.d. .R.e. 004001D0 43 00 68 00 65 00 63 00 6B 00 65 00 64 00 20 00 C.h.e.c.k.e.d. . 004001E0 33 00 32 00 20 00 74 00 69 00 6D 00 65 00 73 00 3.2. .t.i.m.e.s. 004001F0 21 00 !. Alright, let’s focus on our 3rd clue first. which states the following:\n3.Are these True random bytes for Cryptology?\nI initially went down a rabbit hole and thought that the clue meant Cryptology was the encryption software being used.\nI struggled for awhile to even install it and set it up considering it was an outdated software (which I never did since this only ran on very old versions of Windows), until I saw the clue, which showed the logo of the TrueCrypt software.\nOkay, so we’ve recognised the encryption software. The 4th clue also tell us the following:\nIf you need a password, the original reading of the BPB was also Checked and Checked 32 times.\nThis seemed to have hinted towards a key piece of information: CRC32\nWell, we have TrueCrypt and message.bin. Using a hexeditor we just needed to remove the header and footer bytes that contains the clue to make the file a legitimate TrueCrypt volume for mounting.\nI couldn’t figure the password until the challenge hint told us that the password was essentially the flag from the Part 1 (AKA f76635ab), and so with that let’s go ahead and mount the message.bin volume on TrueCrypt, which shows us an image file outer.jpg that shows another hint.\nBruteforcing a CRC32 Hash Collision A leetspeak text consisting of lowercase alphabets and numbers, with a hangman clue for hash collision.\nCombining the hints provided and the clues unravelled thus far, it seems like our next step is to bruteforce out a 9 letter password c-------n that would have a CRC32 hash collision with the 0xf76635ab.\nI went ahead to to write a script to perform this bruteforce (which I left to run while I was working my full time job):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import string import itertools import zlib clash = 0xf76635ab print(f\"CRC32 to clash: {clash}\") charset = string.digits + string.ascii_lowercase for i in itertools.permutations(charset, 7): tmp = ''.join(i) w = 'c' + tmp + 'n' c = zlib.crc32(w.encode()) if c == clash: print(f\"Word clash found with {w}!!\") Turns out that after bruteforcing this the password was revealed to be c01lis1on and I totally did not catch the hint that I was supposed to leetspeak the work collision. I re-wrote another script just for completeness and more facepalm moments:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import string import itertools import zlib clash = 0xf76635ab print(f\"Aiming to clash with {clash}\") REPLACE = {'a': '4', 'b': '8', 'e': '3', 'g': '6', 'i': '1', 'l': '1', 'o': '0', 's': '5', 't': '7', 'z': '2'} # Source: https://stackoverflow.com/questions/29151145/how-can-i-get-all-possible-leet-versions-of-a-string-with-optional-substituti def Leet2Combos(word): possibles = [] for l in word.lower(): ll = REPLACE.get(l, l) possibles.append( (l,) if ll == l else (l, ll) ) return [ ''.join(t) for t in itertools.product(*possibles) ] for w in Leet2Combos('collision'): c = zlib.crc32(w.encode()) #print(f\"Current word: {w} and CRC32 value: {c}\") if c == clash: print(f\"Word clash found with {w}!!\") Inputting this new password when mounting the volume gives us a new file flag.ppsm! Turns out this was actually a TrueCrypt Hidden Volume.\nLet’s see what’s this ppsm file extension\n1 2 └─$ file flag.ppsm flag.ppsm: Microsoft PowerPoint 2007+ Oh, turns out this is a Microsoft PowerPoint file. Let’s go ahead and unzip it! We would notice that there’s a media folder in which we’re presented with 3 files:\nimage1.png image2.jpg media1.mp3 Opening up image2.jpg we’re presented some flipped image.\nFlipping the image we see a string TISC{md5 hash of sound clip}.\nAhh I guess sound clip is referring to media1.mp3. Let’s go get that FLAG\n1 2 └─$ md5sum media1.mp3 f9fc54d767edc937fc24f7827bf91cfe media1.mp3 With that, we have the flag TISC{f9fc54d767edc937fc24f7827bf91cfe}\nFinal Thoughts Wow this was an interesting challenge, rather tedious but nonetheless fun! I like how the administrators gave out hints to help the participants interpret the clues much better and make the route of solving much clearer, without which I may have honestly just given up.\nI hope you guys had fun reading this write-up and my struggle(s) as much as I had playing this CTF!\n","wordCount":"2182","inLanguage":"en","datePublished":"2022-09-12T00:03:00+08:00","dateModified":"2022-09-12T00:03:00+08:00","author":{"@type":"Person","name":"Quentin Khoo"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://quentinkhoo.github.io/posts/tisc-2022-level3-patient0/"},"publisher":{"@type":"Organization","name":"Quentin","logo":{"@type":"ImageObject","url":"https://quentinkhoo.github.io/images/peepoclap.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://quentinkhoo.github.io accesskey=h title="Home (Alt + H)"><img src=https://quentinkhoo.github.io/images/peepoclap.gif alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://quentinkhoo.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://quentinkhoo.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://quentinkhoo.github.io/about/ title=Whoami><span>Whoami</span></a></li><li><a href=https://quentinkhoo.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://quentinkhoo.github.io>Home</a>&nbsp;»&nbsp;<a href=https://quentinkhoo.github.io/posts/>Posts</a></div><h1 class=post-title>TISC 2022 Level 3 - PATIENT0</h1><div class=post-meta><span title='2022-09-12 00:03:00 +0800 +0800'>September 12, 2022</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;2182 words&nbsp;·&nbsp;Quentin Khoo&nbsp;|&nbsp;<a href=https://github.com/quentinkhoo/quentinkhoo.github.io/content/posts/TISC-2022-level3-patient0.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#leaky-matrices-challenge-description>Leaky Matrices Challenge Description</a></li><li><a href=#part-1>Part 1</a><ul><li><a href=#enumerating-the-provided-file>Enumerating the Provided File</a></li><li><a href=#ntfs-and-bios-parameter-block>NTFS and Bios Parameter Block</a></li></ul></li><li><a href=#part-2>Part 2</a><ul><li><a href=#ntfs-alternate-data-streams-ads>NTFS Alternate Data Streams (ADS)</a></li><li><a href=#encrypted-volumes>Encrypted Volumes</a></li><li><a href=#bruteforcing-a-crc32-hash-collision>Bruteforcing a CRC32 Hash Collision</a></li></ul></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div></details></div><div class=post-content><h2 id=leaky-matrices-challenge-description>Leaky Matrices Challenge Description<a hidden class=anchor aria-hidden=true href=#leaky-matrices-challenge-description>#</a></h2><p>This was a forensics challenge unlocked at level 3 that was part of the recent <a href=https://www.csit.gov.sg/events/tisc/tisc-2022>TISC 2022</a> CTF organised by <a href=https://www.csit.gov.sg/>CSIT</a>. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular forensics challenge.</p><h2 id=part-1>Part 1<a hidden class=anchor aria-hidden=true href=#part-1>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DESCRIPTION
</span></span><span class=line><span class=cl>Topic: Forensics
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Palindrome has spread some virus to corrupt machines causing incorrect readings in patients&#39; health measurements and rending them unusable. Inspect the file and see if you can uncover the 8 corrupted bytes that renders the file system unusable?
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Submit your flag in this format: TISC{last 4 bytes in 8 lowercase hex characters}
</span></span></code></pre></td></tr></table></div></div><p>In the process of solving Part 1, I definitely jumped the gun and enumerated the file much more than necessary to solve the first part. Right off the bat I went straight into analyzing what kind of file it was with our trusty <code>file</code> command:</p><h3 id=enumerating-the-provided-file>Enumerating the Provided File<a hidden class=anchor aria-hidden=true href=#enumerating-the-provided-file>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ file PATIENT0    
</span></span><span class=line><span class=cl>PATIENT0: DOS/MBR boot sector, code offset 0x52+2, OEM-ID <span class=s2>&#34;NTFS    &#34;</span>, sectors/cluster 8, Media descriptor 0xf8, sectors/track 0, FAT <span class=o>(</span>1Y bit by descriptor<span class=o>)</span><span class=p>;</span> NTFS, physical drive 0xab3566f7, sectors 12287, <span class=nv>$MFT</span> start cluster 4, <span class=nv>$MFTMirror</span> start cluster 767, bytes/RecordSegment 2^<span class=o>(</span>-1*246<span class=o>)</span>, clusters/index block 1, serial number 05c66c6b160cddda1
</span></span></code></pre></td></tr></table></div></div><p>We can see from this that the provided <code>PATIENT0</code> file is an NTFS partition.</p><p>Let&rsquo;s go ahead and run <code>fls</code> on this to see what files are available on it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>└─$ fls PATIENT0   
</span></span><span class=line><span class=cl>r/r 4-128-1:    $AttrDef
</span></span><span class=line><span class=cl>r/r 8-128-2:    $BadClus
</span></span><span class=line><span class=cl>r/r 8-128-1:    $BadClus:$Bad
</span></span><span class=line><span class=cl>r/r 6-128-1:    $Bitmap
</span></span><span class=line><span class=cl>r/r 7-128-1:    $Boot
</span></span><span class=line><span class=cl>d/d 11-144-2:   $Extend
</span></span><span class=line><span class=cl>r/r 2-128-1:    $LogFile
</span></span><span class=line><span class=cl>r/r 0-128-1:    $MFT
</span></span><span class=line><span class=cl>r/r 1-128-1:    $MFTMirr
</span></span><span class=line><span class=cl>r/r 9-128-2:    $Secure:$SDS
</span></span><span class=line><span class=cl>r/r 9-144-7:    $Secure:$SDH
</span></span><span class=line><span class=cl>r/r 9-144-4:    $Secure:$SII
</span></span><span class=line><span class=cl>r/r 10-128-1:   $UpCase
</span></span><span class=line><span class=cl>r/r 10-128-2:   $UpCase:$Info
</span></span><span class=line><span class=cl>r/r 3-128-3:    $Volume
</span></span><span class=line><span class=cl>r/r 31-128-1:   message.png
</span></span><span class=line><span class=cl>r/r 31-128-3:   message.png:$RAND
</span></span><span class=line><span class=cl>-/r * 32-128-1: broken.pdf
</span></span><span class=line><span class=cl>V/V 256:        $OrphanFiles
</span></span></code></pre></td></tr></table></div></div><p>Hmmm, 3 interesting files found:</p><ul><li><code>broken.pdf</code></li><li><code>message.png</code></li><li><code>message.png:$RAND</code></li></ul><h3 id=ntfs-and-bios-parameter-block>NTFS and Bios Parameter Block<a hidden class=anchor aria-hidden=true href=#ntfs-and-bios-parameter-block>#</a></h3><p>Let&rsquo;s focus on the <code>broken.pdf</code> first. Opening up we see the following:</p><p><img loading=lazy src=/images/posts/tisc-2022-level3-bpb.png alt=BPB></p><p>Hmmm, looks like <code>BPB</code> is a clue. After some googling, turns out BPB stands for <code>BIOS Parameter Block</code>. The following tables (referenced from <a href=http://ntfs.com/ntfs-partition-boot-sector.htm>here</a>) describes the data fields and its respective offset:</p><table><thead><tr><th>Byte Offset</th><th>Field Length</th><th>Field Name</th></tr></thead><tbody><tr><td>0x00</td><td>3 bytes</td><td>Jump Instruction</td></tr><tr><td>0x03</td><td>LONGLONG</td><td>OEM ID</td></tr><tr><td>0x0B</td><td>25 bytes</td><td>BPB</td></tr><tr><td>0x24</td><td>48 bytes</td><td>Extended BPB</td></tr><tr><td>0x54</td><td>426 bytes</td><td>Bootstrap Code</td></tr><tr><td>0x01FE</td><td>WORD</td><td>End of Sector Marker</td></tr></tbody></table><p>Ahhh we can see the BPB and Extended BPB starts at <code>0x0B</code> and <code>0x24</code> respectively, spanning from <code>0x0B - 0x53</code>. Let&rsquo;s take a look at this range of bytes and what do they mean:</p><table><thead><tr><th style=text-align:center>Byte Offset</th><th style=text-align:center>Field Length</th><th>Sample Value</th><th>Field Name</th></tr></thead><tbody><tr><td style=text-align:center>0x0B</td><td style=text-align:center>WORD</td><td>0x0002</td><td>Bytes Per Sector</td></tr><tr><td style=text-align:center>0x0D</td><td style=text-align:center>BYTE</td><td>0x08</td><td>Sectors Per Cluster</td></tr><tr><td style=text-align:center>0x0E</td><td style=text-align:center>WORD</td><td>0x0000</td><td>Reserved Sectors</td></tr><tr><td style=text-align:center>0x10</td><td style=text-align:center>3 BYTES</td><td>0x000000</td><td>always 0</td></tr><tr><td style=text-align:center>0x13</td><td style=text-align:center>WORD</td><td>0x0000</td><td>not used by NTFS</td></tr><tr><td style=text-align:center>0x15</td><td style=text-align:center>BYTE</td><td>0xF8</td><td>Media Descriptor</td></tr><tr><td style=text-align:center>0x16</td><td style=text-align:center>WORD</td><td>0x0000</td><td>always 0</td></tr><tr><td style=text-align:center>0x18</td><td style=text-align:center>WORD</td><td>0x3F00</td><td>Sectors Per Track</td></tr><tr><td style=text-align:center>0x1A</td><td style=text-align:center>WORD</td><td>0xFF00</td><td>Number Of Heads</td></tr><tr><td style=text-align:center>0x1C</td><td style=text-align:center>DWORD</td><td>0x3F000000</td><td>Hidden Sectors</td></tr><tr><td style=text-align:center>0x20</td><td style=text-align:center>DWORD</td><td>0x00000000</td><td>not used by NTFS</td></tr><tr><td style=text-align:center>0x24</td><td style=text-align:center>DWORD</td><td>0x80008000</td><td>not used by NTFS</td></tr><tr><td style=text-align:center>0x28</td><td style=text-align:center>LONGLONG</td><td>0x4AF57F0000000000</td><td>Total Sectors</td></tr><tr><td style=text-align:center>0x30</td><td style=text-align:center>LONGLONG</td><td>0x0400000000000000</td><td>Logical Cluster Number for the file $MFT</td></tr><tr><td style=text-align:center>0x38</td><td style=text-align:center>LONGLONG</td><td>0x54FF070000000000</td><td>Logical Cluster Number for the file $MFTMirr</td></tr><tr><td style=text-align:center>0x40</td><td style=text-align:center>DWORD</td><td>0xF6000000</td><td>Clusters Per File Record Segment</td></tr><tr><td style=text-align:center>0x44</td><td style=text-align:center>BYTE</td><td>0x01</td><td>Clusters Per Index Buffer</td></tr><tr><td style=text-align:center>0x45</td><td style=text-align:center>3 BYTES</td><td>0x000000</td><td>not used by NTFS</td></tr><tr><td style=text-align:center>0x48</td><td style=text-align:center>LONGLONG</td><td>0x14A51B74C91B741C</td><td>Volume Serial Number</td></tr><tr><td style=text-align:center>0x50</td><td style=text-align:center>DWORD</td><td>0x00000000</td><td>Checksum</td></tr></tbody></table><p>Hmm, seems like there&rsquo;s an 8 bytes worth of data <code>not used by NTFS</code> from <code>0x20 - 0x27</code>. Let&rsquo;s investigate this piece of data in a hex editor:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>00000000</span>  EB <span class=m>52</span> <span class=m>90</span> 4E  <span class=m>54</span> <span class=m>46</span> <span class=m>53</span> <span class=m>20</span>   <span class=m>20</span> <span class=m>20</span> <span class=m>20</span> <span class=m>00</span>  <span class=m>02</span> <span class=m>08</span> <span class=m>00</span> <span class=m>00</span>                .R.NTFS    .....
</span></span><span class=line><span class=cl><span class=m>00000010</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> F8 <span class=m>00</span> <span class=m>00</span>   <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>                ................
</span></span><span class=line><span class=cl><span class=m>00000020</span>  <span class=m>54</span> <span class=m>49</span> <span class=m>53</span> <span class=m>43</span>  F7 <span class=m>66</span> <span class=m>35</span> AB   FF 2F <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>                TISC.f5../......
</span></span><span class=line><span class=cl><span class=m>00000030</span>  <span class=m>04</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   FF <span class=m>02</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>                ................
</span></span></code></pre></td></tr></table></div></div><p>Hmmmm, we have some <code>TISC</code> string, and the challenge description tells us to use the last 4 bytes (<code>f76635ab</code>) from the corrupted 8 bytes, giving us the flag <code>TISC{f76635ab}</code>.</p><h2 id=part-2>Part 2<a hidden class=anchor aria-hidden=true href=#part-2>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DESCRIPTION
</span></span><span class=line><span class=cl>Topic: Forensics
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Palindrome must have leaked one of their passwords as the 4 corrupted bytes (Part 1 flag)! Dig deeper to find what was hidden!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Submit your flag in this format: TISC{md5 hash} &lt;-- will be prompted only after opening hidden room.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Note: Please ignore the word &#39;original&#39; in clue 4.
</span></span></code></pre></td></tr></table></div></div><h3 id=ntfs-alternate-data-streams-ads>NTFS Alternate Data Streams (ADS)<a hidden class=anchor aria-hidden=true href=#ntfs-alternate-data-streams-ads>#</a></h3><p>Hmm, no additional file(s). Let&rsquo;s go back to looking at our results from our <code>fls</code> command, in particular the other 2 files that were seemingly interesting.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>r/r 31-128-1:   message.png
</span></span><span class=line><span class=cl>r/r 31-128-3:   message.png:<span class=nv>$RAND</span>
</span></span></code></pre></td></tr></table></div></div><p>It seems like we have an <a href=https://en.wikipedia.org/wiki/NTFS#Alternate_data_stream_(ADS)>Alternate Data Stream</a> hidden within the <code>message.png</code> file. An Alternate Data Stream (ADS) is exclusive to an NTFS formatted file system. It is basically another way of hiding a file within a file (although the hidden file is not exactly WITHIN the facade file, it&rsquo;s just forked into another stream, hence the name Alternate Data Stream).</p><p>Let&rsquo;s extract both files <code>message.png</code> and the ADS to it with <code>icat</code>. <code>icat</code> allows us to essentially output file contents based on an inode number, which is essentially the second column of data from the <code>fls</code> output.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ icat PATIENT0 31-128-1  &gt;&gt; message.png
</span></span><span class=line><span class=cl>└─$ file message.png 
</span></span><span class=line><span class=cl>message.png: PNG image data, <span class=m>1227</span> x 57, 8-bit/color RGB, non-interlaced
</span></span></code></pre></td></tr></table></div></div><p>Opening up the image we get a base32 encoded text in an image. We can recognise it&rsquo;s base32 from the fact that the letters are all in uppercase.</p><p><img loading=lazy src=/images/posts/tisc-2022-level3-message.png alt=message.png></p><p>I used an <a href=https://www.imagetotext.info/>online tool</a> to extract the string out for decoding and with that, I got the next clue!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ <span class=nb>echo</span> <span class=s2>&#34;GIXFI2DJOJZXI6JAMZXXEIDUNBSSAZTMMFTT6ICHN4QGM2LOMQQHI2DFEBZXI4TFMFWS4CQ=&#34;</span> <span class=p>|</span> base32 -d               <span class=m>130</span> ⨯
</span></span><span class=line><span class=cl>2.Thirsty <span class=k>for</span> the flag? Go find the stream.
</span></span></code></pre></td></tr></table></div></div><p>Okay, turns out it wasn&rsquo;t so much of a clue for me since I recognised the presence of the ADS already, this clue just confirms it :p</p><p>so let&rsquo;s go ahead and extract the ADS and analyze it!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ icat PATIENT0 31-128-3 &gt;&gt; message.bin  
</span></span><span class=line><span class=cl>└─$ file message.bin 
</span></span><span class=line><span class=cl>message.bin: data
</span></span></code></pre></td></tr></table></div></div><h3 id=encrypted-volumes>Encrypted Volumes<a hidden class=anchor aria-hidden=true href=#encrypted-volumes>#</a></h3><p>Hmmm, a <code>data</code> file. Let&rsquo;s open it up in a hex editor and see what&rsquo;s up.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>File: message.bin                ASCII Offset: 0x00000000 / 0x004001F1 <span class=o>(</span>%00<span class=o>)</span>   
</span></span><span class=line><span class=cl><span class=m>00000000</span>  <span class=m>33</span> 2E <span class=m>41</span> <span class=m>72</span>  <span class=m>65</span> <span class=m>20</span> <span class=m>74</span> <span class=m>68</span>   <span class=m>65</span> <span class=m>73</span> <span class=m>65</span> <span class=m>20</span>  <span class=m>54</span> <span class=m>72</span> <span class=m>75</span> <span class=m>65</span>                3.Are these True
</span></span><span class=line><span class=cl><span class=m>00000010</span>  <span class=m>20</span> <span class=m>72</span> <span class=m>61</span> 6E  <span class=m>64</span> 6F 6D <span class=m>20</span>   <span class=m>62</span> <span class=m>79</span> <span class=m>74</span> <span class=m>65</span>  <span class=m>73</span> <span class=m>20</span> <span class=m>66</span> 6F                 random bytes fo
</span></span><span class=line><span class=cl><span class=m>00000020</span>  <span class=m>72</span> <span class=m>20</span> <span class=m>43</span> <span class=m>72</span>  <span class=m>79</span> <span class=m>70</span> <span class=m>74</span> 6F   6C 6F <span class=m>67</span> <span class=m>79</span>  3F 4B <span class=m>76</span> <span class=m>18</span>                r Cryptology?Kv.
</span></span><span class=line><span class=cl><span class=m>00000030</span>  7A <span class=m>66</span> <span class=m>97</span> EB  <span class=m>45</span> D8 <span class=m>24</span> D0   DC <span class=m>51</span> 7E <span class=m>42</span>  8D 5A <span class=m>18</span> 3A                zf..E.$..Q~B.Z.:
</span></span></code></pre></td></tr></table></div></div><p>Hmmm, looks like the header of the file gives us our next clue. We also have the 4th clue at the end of the file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>00400120</span>  C1 C5 E1 AB  B3 9B <span class=m>34</span> <span class=m>00</span>   2E <span class=m>00</span> <span class=m>49</span> <span class=m>00</span>  <span class=m>66</span> <span class=m>00</span> <span class=m>20</span> <span class=m>00</span>                ......4...I.f. .
</span></span><span class=line><span class=cl><span class=m>00400130</span>  <span class=m>79</span> <span class=m>00</span> 6F <span class=m>00</span>  <span class=m>75</span> <span class=m>00</span> <span class=m>20</span> <span class=m>00</span>   6E <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>  <span class=m>65</span> <span class=m>00</span> <span class=m>64</span> <span class=m>00</span>                y.o.u. .n.e.e.d.
</span></span><span class=line><span class=cl><span class=m>00400140</span>  <span class=m>20</span> <span class=m>00</span> <span class=m>61</span> <span class=m>00</span>  <span class=m>20</span> <span class=m>00</span> <span class=m>70</span> <span class=m>00</span>   <span class=m>61</span> <span class=m>00</span> <span class=m>73</span> <span class=m>00</span>  <span class=m>73</span> <span class=m>00</span> <span class=m>77</span> <span class=m>00</span>                .a. .p.a.s.s.w.
</span></span><span class=line><span class=cl><span class=m>00400150</span>  6F <span class=m>00</span> <span class=m>72</span> <span class=m>00</span>  <span class=m>64</span> <span class=m>00</span> 2C <span class=m>00</span>   <span class=m>20</span> <span class=m>00</span> <span class=m>74</span> <span class=m>00</span>  <span class=m>68</span> <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>                o.r.d.,. .t.h.e.
</span></span><span class=line><span class=cl><span class=m>00400160</span>  <span class=m>20</span> <span class=m>00</span> 6F <span class=m>00</span>  <span class=m>72</span> <span class=m>00</span> <span class=m>69</span> <span class=m>00</span>   <span class=m>67</span> <span class=m>00</span> <span class=m>69</span> <span class=m>00</span>  6E <span class=m>00</span> <span class=m>61</span> <span class=m>00</span>                .o.r.i.g.i.n.a.
</span></span><span class=line><span class=cl><span class=m>00400170</span>  6C <span class=m>00</span> <span class=m>20</span> <span class=m>00</span>  <span class=m>72</span> <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>   <span class=m>61</span> <span class=m>00</span> <span class=m>64</span> <span class=m>00</span>  <span class=m>69</span> <span class=m>00</span> 6E <span class=m>00</span>                l. .r.e.a.d.i.n.
</span></span><span class=line><span class=cl><span class=m>00400180</span>  <span class=m>67</span> <span class=m>00</span> <span class=m>20</span> <span class=m>00</span>  6F <span class=m>00</span> <span class=m>66</span> <span class=m>00</span>   <span class=m>20</span> <span class=m>00</span> <span class=m>74</span> <span class=m>00</span>  <span class=m>68</span> <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>                g. .o.f. .t.h.e.
</span></span><span class=line><span class=cl><span class=m>00400190</span>  <span class=m>20</span> <span class=m>00</span> <span class=m>42</span> <span class=m>00</span>  <span class=m>50</span> <span class=m>00</span> <span class=m>42</span> <span class=m>00</span>   <span class=m>20</span> <span class=m>00</span> <span class=m>77</span> <span class=m>00</span>  <span class=m>61</span> <span class=m>00</span> <span class=m>73</span> <span class=m>00</span>                .B.P.B. .w.a.s.
</span></span><span class=line><span class=cl>004001A0  <span class=m>20</span> <span class=m>00</span> <span class=m>61</span> <span class=m>00</span>  <span class=m>63</span> <span class=m>00</span> <span class=m>74</span> <span class=m>00</span>   <span class=m>75</span> <span class=m>00</span> <span class=m>61</span> <span class=m>00</span>  6C <span class=m>00</span> 6C <span class=m>00</span>                .a.c.t.u.a.l.l.
</span></span><span class=line><span class=cl>004001B0  <span class=m>79</span> <span class=m>00</span> <span class=m>20</span> <span class=m>00</span>  <span class=m>43</span> <span class=m>00</span> <span class=m>68</span> <span class=m>00</span>   <span class=m>65</span> <span class=m>00</span> <span class=m>63</span> <span class=m>00</span>  6B <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>                y. .C.h.e.c.k.e.
</span></span><span class=line><span class=cl>004001C0  <span class=m>64</span> <span class=m>00</span> <span class=m>20</span> <span class=m>00</span>  <span class=m>61</span> <span class=m>00</span> 6E <span class=m>00</span>   <span class=m>64</span> <span class=m>00</span> <span class=m>20</span> <span class=m>00</span>  <span class=m>52</span> <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>                d. .a.n.d. .R.e.
</span></span><span class=line><span class=cl>004001D0  <span class=m>43</span> <span class=m>00</span> <span class=m>68</span> <span class=m>00</span>  <span class=m>65</span> <span class=m>00</span> <span class=m>63</span> <span class=m>00</span>   6B <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>  <span class=m>64</span> <span class=m>00</span> <span class=m>20</span> <span class=m>00</span>                C.h.e.c.k.e.d. .
</span></span><span class=line><span class=cl>004001E0  <span class=m>33</span> <span class=m>00</span> <span class=m>32</span> <span class=m>00</span>  <span class=m>20</span> <span class=m>00</span> <span class=m>74</span> <span class=m>00</span>   <span class=m>69</span> <span class=m>00</span> 6D <span class=m>00</span>  <span class=m>65</span> <span class=m>00</span> <span class=m>73</span> <span class=m>00</span>                3.2. .t.i.m.e.s.
</span></span><span class=line><span class=cl>004001F0  <span class=m>21</span> <span class=m>00</span>                                     !. 
</span></span></code></pre></td></tr></table></div></div><p>Alright, let&rsquo;s focus on our 3rd clue first. which states the following:</p><p><code>3.Are these True random bytes for Cryptology?</code></p><p>I initially went down a rabbit hole and thought that the clue meant <a href=https://sourceforge.net/projects/cryptology/>Cryptology</a> was the encryption software being used.</p><p><img loading=lazy src=/images/posts/facepalm.png alt=facepalm></p><p>I struggled for awhile to even install it and set it up considering it was an outdated software (which I never did since this only ran on very old versions of Windows), until I saw the clue, which showed the logo of the <a href=https://en.wikipedia.org/wiki/TrueCrypt>TrueCrypt</a> software.</p><p><img loading=lazy src=/images/posts/tisc-2022-level3-truecrypt.png alt=truecrypt></p><p>Okay, so we&rsquo;ve recognised the encryption software. The 4th clue also tell us the following:</p><p><code>If you need a password, the original reading of the BPB was also Checked and Checked 32 times.</code></p><p>This seemed to have hinted towards a key piece of information: <code>CRC32</code></p><p>Well, we have <code>TrueCrypt</code> and <code>message.bin</code>. Using a hexeditor we just needed to remove the header and footer bytes that contains the clue to make the file a legitimate <code>TrueCrypt</code> volume for mounting.</p><p>I couldn&rsquo;t figure the password until the challenge hint told us that the password was essentially the flag from the Part 1 (AKA <code>f76635ab</code>), and so with that let&rsquo;s go ahead and mount the <code>message.bin</code> volume on <code>TrueCrypt</code>, which shows us an image file <code>outer.jpg</code> that shows another hint.</p><p><img loading=lazy src=/images/posts/tisc-2022-level3-outer.jpg alt=outer.jpg></p><h3 id=bruteforcing-a-crc32-hash-collision>Bruteforcing a CRC32 Hash Collision<a hidden class=anchor aria-hidden=true href=#bruteforcing-a-crc32-hash-collision>#</a></h3><p>A leetspeak text consisting of lowercase alphabets and numbers, with a hangman clue for <code>hash collision</code>.</p><p>Combining the hints provided and the clues unravelled thus far, it seems like our next step is to bruteforce out a 9 letter password <code>c-------n</code> that would have a CRC32 hash collision with the <code>0xf76635ab</code>.</p><p>I went ahead to to write a script to perform this bruteforce (which I left to run while I was working my full time job):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>clash</span> <span class=o>=</span> <span class=mh>0xf76635ab</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CRC32 to clash: </span><span class=si>{</span><span class=n>clash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>charset</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span> <span class=o>+</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>permutations</span><span class=p>(</span><span class=n>charset</span><span class=p>,</span> <span class=mi>7</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>tmp</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span> <span class=o>=</span> <span class=s1>&#39;c&#39;</span> <span class=o>+</span> <span class=n>tmp</span> <span class=o>+</span> <span class=s1>&#39;n&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=n>zlib</span><span class=o>.</span><span class=n>crc32</span><span class=p>(</span><span class=n>w</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>c</span> <span class=o>==</span> <span class=n>clash</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Word clash found with </span><span class=si>{</span><span class=n>w</span><span class=si>}</span><span class=s2>!!&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Turns out that after bruteforcing this the password was revealed to be <code>c01lis1on</code> and I totally did not catch the hint that I was supposed to leetspeak the work <code>collision</code>. I re-wrote another script just for completeness and more facepalm moments:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>clash</span> <span class=o>=</span> <span class=mh>0xf76635ab</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Aiming to clash with </span><span class=si>{</span><span class=n>clash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>REPLACE</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;4&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=s1>&#39;8&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>:</span> <span class=s1>&#39;3&#39;</span><span class=p>,</span> <span class=s1>&#39;g&#39;</span><span class=p>:</span> <span class=s1>&#39;6&#39;</span><span class=p>,</span> <span class=s1>&#39;i&#39;</span><span class=p>:</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;l&#39;</span><span class=p>:</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>:</span> <span class=s1>&#39;0&#39;</span><span class=p>,</span> <span class=s1>&#39;s&#39;</span><span class=p>:</span> <span class=s1>&#39;5&#39;</span><span class=p>,</span> <span class=s1>&#39;t&#39;</span><span class=p>:</span> <span class=s1>&#39;7&#39;</span><span class=p>,</span> <span class=s1>&#39;z&#39;</span><span class=p>:</span> <span class=s1>&#39;2&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Source: https://stackoverflow.com/questions/29151145/how-can-i-get-all-possible-leet-versions-of-a-string-with-optional-substituti</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>Leet2Combos</span><span class=p>(</span><span class=n>word</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>possibles</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>l</span> <span class=ow>in</span> <span class=n>word</span><span class=o>.</span><span class=n>lower</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>ll</span> <span class=o>=</span> <span class=n>REPLACE</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=n>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>possibles</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=p>(</span><span class=n>l</span><span class=p>,)</span> <span class=k>if</span> <span class=n>ll</span> <span class=o>==</span> <span class=n>l</span> <span class=k>else</span> <span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=n>ll</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>product</span><span class=p>(</span><span class=o>*</span><span class=n>possibles</span><span class=p>)</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>Leet2Combos</span><span class=p>(</span><span class=s1>&#39;collision&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>c</span> <span class=o>=</span> <span class=n>zlib</span><span class=o>.</span><span class=n>crc32</span><span class=p>(</span><span class=n>w</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>  <span class=c1>#print(f&#34;Current word: {w} and CRC32 value: {c}&#34;)</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=n>c</span> <span class=o>==</span> <span class=n>clash</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Word clash found with </span><span class=si>{</span><span class=n>w</span><span class=si>}</span><span class=s2>!!&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Inputting this new password when mounting the volume gives us a new file <code>flag.ppsm</code>! Turns out this was actually a <a href=https://www.truecrypt71a.com/documentation/plausible-deniability/hidden-volume>TrueCrypt Hidden Volume</a>.</p><p>Let&rsquo;s see what&rsquo;s this <code>ppsm</code> file extension</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ file flag.ppsm   
</span></span><span class=line><span class=cl>flag.ppsm: Microsoft PowerPoint 2007+
</span></span></code></pre></td></tr></table></div></div><p>Oh, turns out this is a Microsoft PowerPoint file. Let&rsquo;s go ahead and <code>unzip</code> it! We would notice that there&rsquo;s a <code>media</code> folder in which we&rsquo;re presented with 3 files:</p><ul><li><code>image1.png</code></li><li><code>image2.jpg</code></li><li><code>media1.mp3</code></li></ul><p>Opening up <code>image2.jpg</code> we&rsquo;re presented some flipped image.</p><p><img loading=lazy src=/images/posts/tisc-2022-level3-image2.jpg alt=image2></p><p>Flipping the image we see a string <code>TISC{md5 hash of sound clip}</code>.</p><p>Ahh I guess sound clip is referring to <code>media1.mp3</code>. Let&rsquo;s go get that FLAG</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ md5sum media1.mp3 
</span></span><span class=line><span class=cl>f9fc54d767edc937fc24f7827bf91cfe  media1.mp3
</span></span></code></pre></td></tr></table></div></div><p>With that, we have the flag <code>TISC{f9fc54d767edc937fc24f7827bf91cfe}</code></p><h2 id=final-thoughts>Final Thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h2><p>Wow this was an interesting challenge, rather tedious but nonetheless fun! I like how the administrators gave out hints to help the participants interpret the clues much better and make the route of solving much clearer, without which I may have honestly just given up.</p><p>I hope you guys had fun reading this write-up and my struggle(s) as much as I had playing this CTF!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://quentinkhoo.github.io/tags/ctf/>ctf</a></li><li><a href=https://quentinkhoo.github.io/tags/tisc-2022/>tisc-2022</a></li><li><a href=https://quentinkhoo.github.io/tags/forensics/>forensics</a></li><li><a href=https://quentinkhoo.github.io/tags/crc32/>crc32</a></li><li><a href=https://quentinkhoo.github.io/tags/bruteforce/>bruteforce</a></li><li><a href=https://quentinkhoo.github.io/tags/autopsy/>autopsy</a></li><li><a href=https://quentinkhoo.github.io/tags/hash-collision/>hash-collision</a></li><li><a href=https://quentinkhoo.github.io/tags/ntfs/>ntfs</a></li><li><a href=https://quentinkhoo.github.io/tags/bios-parameter-block/>bios-parameter-block</a></li><li><a href=https://quentinkhoo.github.io/tags/ads/>ads</a></li><li><a href=https://quentinkhoo.github.io/tags/truecrypt/>truecrypt</a></li></ul><nav class=paginav><a class=prev href=https://quentinkhoo.github.io/posts/tisc-2022-level4b-cloudynekos/><span class=title>« Prev</span><br><span>TISC 2022 Level 4B - Cloudynekos</span></a>
<a class=next href=https://quentinkhoo.github.io/posts/tisc-2022-level2-leaky-matrices/><span class=title>Next »</span><br><span>TISC 2022 Level 2 - Leaky Matrices</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 3 - PATIENT0 on twitter" href="https://twitter.com/intent/tweet/?text=TISC%202022%20Level%203%20-%20PATIENT0&url=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level3-patient0%2f&hashtags=ctf%2ctisc-2022%2cforensics%2ccrc32%2cbruteforce%2cautopsy%2chash-collision%2cntfs%2cbios-parameter-block%2cads%2ctruecrypt"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 3 - PATIENT0 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level3-patient0%2f&title=TISC%202022%20Level%203%20-%20PATIENT0&summary=TISC%202022%20Level%203%20-%20PATIENT0&source=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level3-patient0%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 3 - PATIENT0 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level3-patient0%2f&title=TISC%202022%20Level%203%20-%20PATIENT0"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 3 - PATIENT0 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level3-patient0%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 3 - PATIENT0 on whatsapp" href="https://api.whatsapp.com/send?text=TISC%202022%20Level%203%20-%20PATIENT0%20-%20https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level3-patient0%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 3 - PATIENT0 on telegram" href="https://telegram.me/share/url?text=TISC%202022%20Level%203%20-%20PATIENT0&url=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level3-patient0%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://quentinkhoo.github.io>Quentin</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>