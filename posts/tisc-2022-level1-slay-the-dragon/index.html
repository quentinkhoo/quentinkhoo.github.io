<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TISC 2022 Level 1 - Slay The Dragon | Quentin</title><meta name=keywords content="ctf,tisc-2022,python,pwn"><meta name=description content="Slay the Dragon Challenge Description This was a pwn challenge and also the first challenge of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular pwn challenge."><meta name=author content="Quentin Khoo"><link rel=canonical href=https://quentinkhoo.github.io/posts/tisc-2022-level1-slay-the-dragon/><link crossorigin=anonymous href=/assets/css/stylesheet.993f9097e8d870439c2a9670fc4104ef9ca11ba29707a5a8cb5095b67a2ae128.css integrity="sha256-mT+Ql+jYcEOcKpZw/EEE75yhG6KXB6Woy1CVtnoq4Sg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://quentinkhoo.github.io/images/peepoclap.gif><link rel=icon type=image/png sizes=16x16 href=https://quentinkhoo.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://quentinkhoo.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://quentinkhoo.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://quentinkhoo.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="TISC 2022 Level 1 - Slay The Dragon"><meta property="og:description" content="Slay the Dragon Challenge Description This was a pwn challenge and also the first challenge of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular pwn challenge."><meta property="og:type" content="article"><meta property="og:url" content="https://quentinkhoo.github.io/posts/tisc-2022-level1-slay-the-dragon/"><meta property="og:image" content="https://quentinkhoo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-12T00:01:00+08:00"><meta property="article:modified_time" content="2022-09-12T00:01:00+08:00"><meta property="og:site_name" content="Quentin"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://quentinkhoo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="TISC 2022 Level 1 - Slay The Dragon"><meta name=twitter:description content="Slay the Dragon Challenge Description This was a pwn challenge and also the first challenge of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular pwn challenge."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://quentinkhoo.github.io/posts/"},{"@type":"ListItem","position":3,"name":"TISC 2022 Level 1 - Slay The Dragon","item":"https://quentinkhoo.github.io/posts/tisc-2022-level1-slay-the-dragon/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TISC 2022 Level 1 - Slay The Dragon","name":"TISC 2022 Level 1 - Slay The Dragon","description":"Slay the Dragon Challenge Description This was a pwn challenge and also the first challenge of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular pwn challenge.","keywords":["ctf","tisc-2022","python","pwn"],"articleBody":"Slay the Dragon Challenge Description This was a pwn challenge and also the first challenge of the recent TISC 2022 CTF organised by CSIT. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular pwn challenge.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 DESCRIPTION Topic: Pwn The recently launched online RPG game \"Slay The Dragon\" has been hot topic in the online gaming community of late, due to a seemingly impossible final boss. Amongst the multiple tirades against the forementioned boss, much controversy has been brewing due to rumors of the game being a recruitment campaign for PALINDROME, the cybercriminal organisation responsible for recent cyberattacks on Singapore's critical infrastructure. You are tasked to find a way to beat (hack) the game and provide us with the flag (a string in the format TISC{xxx}) that would be displayed after beating the final boss. Your success is critical to ensure the safety of Singapore's cyberspace, as it would allow us to send more undercover operatives to infiltrate PALINDROME. To aid in your efforts, we have managed to obtain the source code of the game for you. We look forward to your success! You will be provided with the following: 1. Source code for game client/server (Python 3.10.x) 2. Game client executable (Compiled with PyInstaller) - Highly recommended that you run it in a modern terminal (not cmd.exe) for the optimal experience: - Windows: Windows Terminal or ConEmu recommended. - Linux: the default terminal should be fine. Note: If you'd like to make any modifications to the client, we'd strongly suggest modifying the source code and running it directly. The game client executable has been provided purely for your convenience in checking out the game. Host: chal00bq3ouweqtzva9xcobep6spl5m75fucey.ctf.sg Port: 18261 ATTACHED FILES slay_the_dragon.zip Introduction Although the category was a pwn challenge, I would consider this more of a “source code review” challenge and spotting the vulnerability to be exploited. This was achieved by abusing the lack of proper server side validation from client side input. The provided source code can be found here.\nThere were 3 bosses residing on the actual server, of which we had to defeat all 3 bosses in order to unlock the flag. We know this is the case by inspecting the server/service/batttleservice.py file, under the __handle_battle_win(self) function:\n1 2 3 4 5 6 7 8 def __handle_battle_win(self): self.server.game.remove_next_boss() if self.__boss_available_for_next_battle(): self.server.send_result(Result.VALIDATED_OK) return self.server.send_result(Result.OBTAINED_FLAG) self.server.send_flag() self.server.exit() We can only upgrade our sword once, from a measely 1 ATK point to 3 ATK points. We also have a starting HP of 10.\nThe first boss with an ATK of 1 and HP of 5 could be beaten easily, without resorting to any form of cheats/hacks/soure code modification.\nThe second boss however, had an ATK of 3 and HP of 30, and this led to the first exploit.\nInfinite Money Hack Without Dying If we studied the client side’s workevent.py, we see the following piece of code:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 CREEPER_ENCOUNTER_CHANCE = 0.2 class WorkEvent: def __init__(self, client: GameClient) -\u003e None: self.client = client def run(self): if random() \u003c= CREEPER_ENCOUNTER_CHANCE: self.__die_to_creeper() self.__mine_safely() def __die_to_creeper(self): screens.display_creeper_screen() screens.display_game_over_screen() self.client.exit() def __mine_safely(self): screens.display_working_screen() self.client.send_command(Command.WORK) By removing the if statement and never having the chance of randomly running the __die_to_creeper function, we can effectively mine gold infinitely without having to worry about randomly dying!\nThis helped in defeating the second boss by consuming infinite potions during the course of the battle, but does not exactly help for the final boss as that one dealt a 1 hit K.O and I guess this is where the challenge really came in.\nMulti-Attack Hack Let’s first study and understand how the server side battle code works:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 # server/networking/client.py @staticmethod def send(data: str): sys.stdout.buffer.write(encode(data)) sys.stdout.buffer.flush() @staticmethod def recv() -\u003e str: return decode(NetClient.__recvuntil(EOF_MARKER)) @staticmethod def __recvuntil(marker: str) -\u003e bytes: data = b\"\" while True: current_byte = sys.stdin.buffer.read(1) if current_byte == marker.encode(): break data += current_byte return data Going through server/networking/client.py, we can see that when data is received, it is received until the EOF_MARKER, which is just the # character as defined in core/config.py.\n1 2 # Protocol EOF_MARKER = \"#\" On the other hand, decode and encode is simply done in base64 as shown in core/networking/protocol.py.\n1 2 3 4 5 6 7 8 9 from base64 import b64decode, b64encode from core.config import EOF_MARKER def encode(data: str) -\u003e bytes: return b64encode(data.encode()) + EOF_MARKER.encode() def decode(data: bytes) -\u003e str: return b64decode(data).decode() I guess the next thing to understand is the way the server processes a battle. Let’s take a look at the __compute_battle_outcome(self) under server/service/battleservice.py:\n1 2 3 4 5 6 7 8 9 10 11 12 13 def __compute_battle_outcome(self) -\u003e Optional[Result]: for command in self.history.commands: match command: case Command.ATTACK: self.boss.receive_attack_from(self.player) if self.boss.is_dead: return Result.PLAYER_WIN_BATTLE case Command.HEAL: self.player.use_potion() case Command.BOSS_ATTACK: self.player.receive_attack_from(self.boss) if self.player.is_dead: return Result.BOSS_WIN_BATTLE Okay, from this we know that commands are iterated from self.history.commands. Let’s take a look and see how this is populated. We can understand this from the run(self) function:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 def run(self): self.__send_next_boss() while True: self.history.log_commands_from_str(self.server.recv_command_str()) match self.history.latest: case Command.ATTACK | Command.HEAL: self.history.log_command(Command.BOSS_ATTACK) case Command.VALIDATE: break case Command.RUN: return case _: self.server.exit(1) match self.__compute_battle_outcome(): case Result.PLAYER_WIN_BATTLE: self.__handle_battle_win() return case Result.BOSS_WIN_BATTLE: self.server.exit() case _: self.server.exit(1) Ahh, it seems like commands are stored in self.history.commands through the log_commands_from_str(self, command_str: str) function seen in core/models/command.py.\nLet’s take a deeper look at log_commands_from_str():\n1 2 3 4 5 def log_commands_from_str(self, commands_str: str): self.log_commands( [Command(command_str) for command_str in commands_str.split()] ) Hmmm, what’s interesting here is the use of commands_str.split(), which in python sense is splitting commands by the space delimeter.\nAt this an attack idea could be to send ATTACK ATTACK ATTACK .... ATTACK for up to an indefinite number of times, which would result in the server processing multiple ATTACK commands. Let’s trace how a single ATTACK happens:\nClient sends an ATTACK command Server receives ATTACK command If the boss dies, the PLAY_WIN_BATTLE result is returned and the FLAG is sent. Server runs log_command for BOSS_ATTACK command We notice this in run(self) under server/service/battleservice.py 1 2 case Command.ATTACK | Command.HEAL: self.history.log_command(Command.BOSS_ATTACK) Server sends a BOSS_ATTACK command Client receives BOSS_ATTACK command Hmmm, so it seems like for each ATTACK command, we have to send receive the BOSS_ATTACK as well. Well, the advantage to take of also comes from the fact that we can send multiple ATTACK commands first and it would calculate if the boss dies before the boss attacks. So, let’s spam the boss with ATTACK before it even has the chance to strike back, like in a real game!\nThe Hack - Source Code Modification So my approach would be to introduce a HACK command into the gameclient that we can invoke:\nLet’s first modify the core/models/command.py file to include a HACK command:\n1 2 3 4 5 6 7 class Command(Enum): ATTACK = \"ATTACK\" BATTLE = \"BATTLE\" HACK = \"HACK\" # ... # ... # ... In the client/gameclient.py, we create a hack_command(self, str) function:\n1 2 def hack_command(self, str): self.__send(str) Under our client/event/battleevent.py we create a new __hack_boss(self) function. This is also where we inject our payload:\n1 2 3 4 def __hack_boss(self): self.client.hack_command(\"ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK \") for i in range(120): self.boss.receive_attack_from(self.player) I chose to ATTACK a 120 times only because my initial copy-pasta had 30 ATTACK commands and I was just lazy :P\nAnd finally, we create a way to invoke the HACK command by adding an additional option to through the switch/case statement in client/event/battleevent.py, which invokes the __hack_boss() function:\n1 2 3 4 case Command.HACK: self.__hack_boss() if self.boss.is_dead: break To immerse in the experience fully, let’s also update the get_battle_menu() function under client/ui/menus.py as well:\n1 2 3 4 5 6 7 def get_battle_menu() -\u003e str: return ( \" [red]1. [yellow]ATTACK\\n\" + \" [red]2. [yellow]HEAL\\n\" + \" [red]3. [yellow]RUN\\n\" + \" [red]4. [yellow]HACK\" ) Alright let’s run the HACK command against each boss and eventually, we will get the FLAG:\n1 2 3 4 5 6 7 8 9 10 11 █████ █████ █████ █████ █████ ██ ███ █████ ██ ██ ██ █ ██ ██ ██ ██ ██ ██ █████ ███ ███ ██ ██████ ██ ██ █████ █████ █████ ██ ██ ██ ███ ██ █ ██ ██ ██ ██ ██ ██ ██ ██ ██ ███████ ███ ██ ███ ██████ █████ █████ █████ █████ ███████ ██ ██ █████ ██ ██ Thank you for playing, here is your flag: TISC{L3T5_M33T_4G41N_1N_500_Y34R5_96eef57b46a6db572c08eef5f1924bc3} ","wordCount":"1619","inLanguage":"en","datePublished":"2022-09-12T00:01:00+08:00","dateModified":"2022-09-12T00:01:00+08:00","author":{"@type":"Person","name":"Quentin Khoo"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://quentinkhoo.github.io/posts/tisc-2022-level1-slay-the-dragon/"},"publisher":{"@type":"Organization","name":"Quentin","logo":{"@type":"ImageObject","url":"https://quentinkhoo.github.io/images/peepoclap.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://quentinkhoo.github.io accesskey=h title="Home (Alt + H)"><img src=https://quentinkhoo.github.io/images/peepoclap.gif alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://quentinkhoo.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://quentinkhoo.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://quentinkhoo.github.io/about/ title=Whoami><span>Whoami</span></a></li><li><a href=https://quentinkhoo.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://quentinkhoo.github.io>Home</a>&nbsp;»&nbsp;<a href=https://quentinkhoo.github.io/posts/>Posts</a></div><h1 class=post-title>TISC 2022 Level 1 - Slay The Dragon</h1><div class=post-meta><span title='2022-09-12 00:01:00 +0800 +0800'>September 12, 2022</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1619 words&nbsp;·&nbsp;Quentin Khoo&nbsp;|&nbsp;<a href=https://github.com/quentinkhoo/quentinkhoo.github.io/content/posts/TISC-2022-level1-slay-the-dragon.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#slay-the-dragon-challenge-description>Slay the Dragon Challenge Description</a></li><li><a href=#introduction>Introduction</a></li><li><a href=#infinite-money-hack-without-dying>Infinite Money Hack Without Dying</a></li><li><a href=#multi-attack-hack>Multi-Attack Hack</a></li><li><a href=#the-hack---source-code-modification>The Hack - Source Code Modification</a></li></ul></nav></div></details></div><div class=post-content><h2 id=slay-the-dragon-challenge-description>Slay the Dragon Challenge Description<a hidden class=anchor aria-hidden=true href=#slay-the-dragon-challenge-description>#</a></h2><p>This was a pwn challenge and also the first challenge of the recent <a href=https://www.csit.gov.sg/events/tisc/tisc-2022>TISC 2022</a> CTF organised by <a href=https://www.csit.gov.sg/>CSIT</a>. TISC 2022 was an individual CTF that is level-based and not exactly a typical jeopardy-style CTF, meaning that only 1 challenge is released at a time and only after you solve that 1 challenge do you unlock the next one. In this writeup, I will discuss my approach towards solving this particular pwn challenge.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DESCRIPTION
</span></span><span class=line><span class=cl>Topic: Pwn
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The recently launched online RPG game &#34;Slay The Dragon&#34; has been hot topic in the online gaming community of late, due to a seemingly impossible final boss. Amongst the multiple tirades against the forementioned boss, much controversy has been brewing due to rumors of the game being a recruitment campaign for PALINDROME, the cybercriminal organisation responsible for recent cyberattacks on Singapore&#39;s critical infrastructure.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>You are tasked to find a way to beat (hack) the game and provide us with the flag (a string in the format TISC{xxx}) that would be displayed after beating the final boss. Your success is critical to ensure the safety of Singapore&#39;s cyberspace, as it would allow us to send more undercover operatives to infiltrate PALINDROME.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>To aid in your efforts, we have managed to obtain the source code of the game for you. We look forward to your success!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>You will be provided with the following:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. Source code for game client/server (Python 3.10.x)
</span></span><span class=line><span class=cl>2. Game client executable (Compiled with PyInstaller)
</span></span><span class=line><span class=cl>- Highly recommended that you run it in a modern terminal (not cmd.exe) for the optimal experience:
</span></span><span class=line><span class=cl>- Windows: Windows Terminal or ConEmu recommended.
</span></span><span class=line><span class=cl>- Linux: the default terminal should be fine.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Note: If you&#39;d like to make any modifications to the client, we&#39;d strongly suggest modifying the source code and running it directly. The game client executable has been provided purely for your convenience in checking out the game.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host: chal00bq3ouweqtzva9xcobep6spl5m75fucey.ctf.sg
</span></span><span class=line><span class=cl>Port: 18261
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ATTACHED FILES
</span></span><span class=line><span class=cl>slay_the_dragon.zip
</span></span></code></pre></td></tr></table></div></div><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>Although the category was a <code>pwn</code> challenge, I would consider this more of a &ldquo;source code review&rdquo; challenge and spotting the vulnerability to be exploited. This was achieved by abusing the lack of proper server side validation from client side input. The provided source code can be found <a href=https://github.com/quentinkhoo/quentinkhoo.github.io/raw/main/static/files/posts/tisc2022/slay_the_dragon.zip>here</a>.</p><p>There were 3 bosses residing on the actual server, of which we had to defeat all 3 bosses in order to unlock the flag. We know this is the case by inspecting the <code>server/service/batttleservice.py</code> file, under the <code>__handle_battle_win(self)</code> function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>__handle_battle_win</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>game</span><span class=o>.</span><span class=n>remove_next_boss</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>__boss_available_for_next_battle</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>send_result</span><span class=p>(</span><span class=n>Result</span><span class=o>.</span><span class=n>VALIDATED_OK</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>send_result</span><span class=p>(</span><span class=n>Result</span><span class=o>.</span><span class=n>OBTAINED_FLAG</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>send_flag</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>We can only upgrade our sword once, from a measely 1 ATK point to 3 ATK points. We also have a starting HP of 10.</p><p>The first boss with an ATK of 1 and HP of 5 could be beaten easily, without resorting to any form of cheats/hacks/soure code modification.</p><p>The second boss however, had an ATK of 3 and HP of 30, and this led to the first exploit.</p><h2 id=infinite-money-hack-without-dying>Infinite Money Hack Without Dying<a hidden class=anchor aria-hidden=true href=#infinite-money-hack-without-dying>#</a></h2><p>If we studied the client side&rsquo;s <code>workevent.py</code>, we see the following piece of code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>CREEPER_ENCOUNTER_CHANCE</span> <span class=o>=</span> <span class=mf>0.2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>WorkEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>client</span><span class=p>:</span> <span class=n>GameClient</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>client</span> <span class=o>=</span> <span class=n>client</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>random</span><span class=p>()</span> <span class=o>&lt;=</span> <span class=n>CREEPER_ENCOUNTER_CHANCE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>__die_to_creeper</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>__mine_safely</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__die_to_creeper</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>screens</span><span class=o>.</span><span class=n>display_creeper_screen</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>screens</span><span class=o>.</span><span class=n>display_game_over_screen</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__mine_safely</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>screens</span><span class=o>.</span><span class=n>display_working_screen</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>send_command</span><span class=p>(</span><span class=n>Command</span><span class=o>.</span><span class=n>WORK</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>By removing the <code>if</code> statement and never having the chance of randomly running the <code>__die_to_creeper</code> function, we can effectively mine gold infinitely without having to worry about randomly dying!</p><p>This helped in defeating the second boss by consuming infinite potions during the course of the battle, but does not exactly help for the final boss as that one dealt a 1 hit K.O and I guess this is where the challenge really came in.</p><h2 id=multi-attack-hack>Multi-Attack Hack<a hidden class=anchor aria-hidden=true href=#multi-attack-hack>#</a></h2><p>Let&rsquo;s first study and understand how the server side battle code works:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># server/networking/client.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>buffer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>encode</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>buffer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>recv</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>decode</span><span class=p>(</span><span class=n>NetClient</span><span class=o>.</span><span class=n>__recvuntil</span><span class=p>(</span><span class=n>EOF_MARKER</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>__recvuntil</span><span class=p>(</span><span class=n>marker</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>current_byte</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>stdin</span><span class=o>.</span><span class=n>buffer</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>current_byte</span> <span class=o>==</span> <span class=n>marker</span><span class=o>.</span><span class=n>encode</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>+=</span> <span class=n>current_byte</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span>
</span></span></code></pre></td></tr></table></div></div><p>Going through <code>server/networking/client.py</code>, we can see that when data is received, it is received until the <code>EOF_MARKER</code>, which is just the <code>#</code> character as defined in <code>core/config.py</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Protocol</span>
</span></span><span class=line><span class=cl><span class=n>EOF_MARKER</span> <span class=o>=</span> <span class=s2>&#34;#&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>On the other hand, <code>decode</code> and <code>encode</code> is simply done in base64 as shown in <code>core/networking/protocol.py</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>base64</span> <span class=kn>import</span> <span class=n>b64decode</span><span class=p>,</span> <span class=n>b64encode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>core.config</span> <span class=kn>import</span> <span class=n>EOF_MARKER</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encode</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>b64encode</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span> <span class=o>+</span> <span class=n>EOF_MARKER</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decode</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>b64decode</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>I guess the next thing to understand is the way the server processes a battle. Let&rsquo;s take a look at the <code>__compute_battle_outcome(self)</code> under <code>server/service/battleservice.py</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>__compute_battle_outcome</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Result</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>command</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>commands</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>match</span> <span class=n>command</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>case</span> <span class=n>Command</span><span class=o>.</span><span class=n>ATTACK</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>boss</span><span class=o>.</span><span class=n>receive_attack_from</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>player</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>boss</span><span class=o>.</span><span class=n>is_dead</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>Result</span><span class=o>.</span><span class=n>PLAYER_WIN_BATTLE</span>
</span></span><span class=line><span class=cl>            <span class=n>case</span> <span class=n>Command</span><span class=o>.</span><span class=n>HEAL</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>player</span><span class=o>.</span><span class=n>use_potion</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>case</span> <span class=n>Command</span><span class=o>.</span><span class=n>BOSS_ATTACK</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>player</span><span class=o>.</span><span class=n>receive_attack_from</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>boss</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>player</span><span class=o>.</span><span class=n>is_dead</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>Result</span><span class=o>.</span><span class=n>BOSS_WIN_BATTLE</span>
</span></span></code></pre></td></tr></table></div></div><p>Okay, from this we know that commands are iterated from <code>self.history.commands</code>. Let&rsquo;s take a look and see how this is populated. We can understand this from the <code>run(self)</code> function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>__send_next_boss</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>log_commands_from_str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>recv_command_str</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>match</span> <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>latest</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>case</span> <span class=n>Command</span><span class=o>.</span><span class=n>ATTACK</span> <span class=o>|</span> <span class=n>Command</span><span class=o>.</span><span class=n>HEAL</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>log_command</span><span class=p>(</span><span class=n>Command</span><span class=o>.</span><span class=n>BOSS_ATTACK</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>case</span> <span class=n>Command</span><span class=o>.</span><span class=n>VALIDATE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>            <span class=n>case</span> <span class=n>Command</span><span class=o>.</span><span class=n>RUN</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span>
</span></span><span class=line><span class=cl>            <span class=n>case</span> <span class=n>_</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>match</span> <span class=bp>self</span><span class=o>.</span><span class=n>__compute_battle_outcome</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>case</span> <span class=n>Result</span><span class=o>.</span><span class=n>PLAYER_WIN_BATTLE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>__handle_battle_win</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        <span class=n>case</span> <span class=n>Result</span><span class=o>.</span><span class=n>BOSS_WIN_BATTLE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>case</span> <span class=n>_</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>server</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Ahh, it seems like commands are stored in <code>self.history.commands</code> through the <code>log_commands_from_str(self, command_str: str)</code> function seen in <code>core/models/command.py</code>.</p><p>Let&rsquo;s take a deeper look at <code>log_commands_from_str()</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>log_commands_from_str</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>commands_str</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>log_commands</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=n>Command</span><span class=p>(</span><span class=n>command_str</span><span class=p>)</span> <span class=k>for</span> <span class=n>command_str</span> <span class=ow>in</span> <span class=n>commands_str</span><span class=o>.</span><span class=n>split</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Hmmm, what&rsquo;s interesting here is the use of <code>commands_str.split()</code>, which in python sense is splitting commands by the space delimeter.</p><p>At this an attack idea could be to send <code>ATTACK ATTACK ATTACK .... ATTACK</code> for up to an indefinite number of times, which would result in the server processing multiple <code>ATTACK</code> commands. Let&rsquo;s trace how a single <code>ATTACK</code> happens:</p><ol><li>Client sends an <code>ATTACK</code> command</li><li>Server receives <code>ATTACK</code> command<ul><li>If the boss dies, the <code>PLAY_WIN_BATTLE</code> result is returned and the FLAG is sent.</li></ul></li><li>Server runs <code>log_command</code> for <code>BOSS_ATTACK</code> command<ul><li>We notice this in <code>run(self)</code> under <code>server/service/battleservice.py</code><ul><li><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> case Command.ATTACK | Command.HEAL:
</span></span><span class=line><span class=cl>     self.history.log_command(Command.BOSS_ATTACK)
</span></span></code></pre></td></tr></table></div></div></li></ul></li></ul></li><li>Server sends a <code>BOSS_ATTACK</code> command</li><li>Client receives <code>BOSS_ATTACK</code> command</li></ol><p>Hmmm, so it seems like for each <code>ATTACK</code> command, we have to send receive the <code>BOSS_ATTACK</code> as well. Well, the advantage to take of also comes from the fact that we can send multiple <code>ATTACK</code> commands first and it would calculate if the boss dies before the boss attacks. So, let&rsquo;s spam the boss with <code>ATTACK</code> before it even has the chance to strike back, like in a real game!</p><h2 id=the-hack---source-code-modification>The Hack - Source Code Modification<a hidden class=anchor aria-hidden=true href=#the-hack---source-code-modification>#</a></h2><p>So my approach would be to introduce a <code>HACK</code> command into the gameclient that we can invoke:</p><p>Let&rsquo;s first modify the <code>core/models/command.py</code> file to include a <code>HACK</code> command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Command</span><span class=p>(</span><span class=n>Enum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ATTACK</span> <span class=o>=</span> <span class=s2>&#34;ATTACK&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>BATTLE</span> <span class=o>=</span> <span class=s2>&#34;BATTLE&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>HACK</span> <span class=o>=</span> <span class=s2>&#34;HACK&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># ...</span>
</span></span><span class=line><span class=cl><span class=c1># ...</span>
</span></span><span class=line><span class=cl><span class=c1># ...</span>
</span></span></code></pre></td></tr></table></div></div><p>In the <code>client/gameclient.py</code>, we create a <code>hack_command(self, str)</code> function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>hack_command</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>__send</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Under our <code>client/event/battleevent.py</code> we create a new <code>__hack_boss(self)</code> function. This is also where we inject our payload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>__hack_boss</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>hack_command</span><span class=p>(</span><span class=s2>&#34;ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK ATTACK &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>120</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>boss</span><span class=o>.</span><span class=n>receive_attack_from</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>player</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>I chose to ATTACK a 120 times only because my initial copy-pasta had 30 <code>ATTACK</code> commands and I was just lazy :P</p><p>And finally, we create a way to invoke the <code>HACK</code> command by adding an additional option to through the switch/case statement in <code>client/event/battleevent.py</code>, which invokes the <code>__hack_boss()</code> function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>case</span> <span class=n>Command</span><span class=o>.</span><span class=n>HACK</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>__hack_boss</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>boss</span><span class=o>.</span><span class=n>is_dead</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><p>To immerse in the experience fully, let&rsquo;s also update the <code>get_battle_menu()</code> function under <code>client/ui/menus.py</code> as well:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_battle_menu</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;   [red]1. [yellow]ATTACK</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>+</span> <span class=s2>&#34;   [red]2. [yellow]HEAL</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>+</span> <span class=s2>&#34;   [red]3. [yellow]RUN</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>+</span> <span class=s2>&#34;   [red]4. [yellow]HACK&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Alright let&rsquo;s run the <code>HACK</code> command against each boss and eventually, we will get the FLAG:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl>   <span class=err>█████</span>    <span class=err>█████</span>   <span class=err>█████</span>   <span class=err>█████</span>      <span class=err>█████</span>  <span class=err>██</span>        <span class=err>███</span>   <span class=err>█████</span> <span class=err>██</span>   <span class=err>██</span>
</span></span><span class=line><span class=cl>   <span class=err>██</span>   <span class=err>█</span>  <span class=err>██</span>   <span class=err>██</span> <span class=err>██</span>      <span class=err>██</span>         <span class=err>██</span>      <span class=err>██</span>       <span class=err>█████</span>   <span class=err>███</span>  <span class=err>███</span>  <span class=err>██</span>
</span></span><span class=line><span class=cl>   <span class=err>██████</span>  <span class=err>██</span>   <span class=err>██</span>  <span class=err>█████</span>   <span class=err>█████</span>      <span class=err>█████</span>  <span class=err>██</span>      <span class=err>██</span>   <span class=err>██</span>  <span class=err>███</span>  <span class=err>██</span> <span class=err>█</span> <span class=err>██</span>
</span></span><span class=line><span class=cl>   <span class=err>██</span>   <span class=err>██</span> <span class=err>██</span>   <span class=err>██</span>      <span class=err>██</span>      <span class=err>██</span>         <span class=err>██</span> <span class=err>██</span>      <span class=err>███████</span>  <span class=err>███</span>  <span class=err>██</span>  <span class=err>███</span>
</span></span><span class=line><span class=cl>   <span class=err>██████</span>   <span class=err>█████</span>   <span class=err>█████</span>   <span class=err>█████</span>      <span class=err>█████</span>  <span class=err>███████</span> <span class=err>██</span>   <span class=err>██</span> <span class=err>█████</span> <span class=err>██</span>   <span class=err>██</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                   <span class=n>Thank</span> <span class=n>you</span> <span class=k>for</span> <span class=n>playing</span><span class=p>,</span> <span class=n>here</span> <span class=n>is</span> <span class=n>your</span> <span class=n>flag</span><span class=err>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>TISC</span><span class=p>{</span><span class=n>L3T5_M33T_4G41N_1N_500_Y34R5_96eef57b46a6db572c08eef5f1924bc3</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://quentinkhoo.github.io/tags/ctf/>ctf</a></li><li><a href=https://quentinkhoo.github.io/tags/tisc-2022/>tisc-2022</a></li><li><a href=https://quentinkhoo.github.io/tags/python/>python</a></li><li><a href=https://quentinkhoo.github.io/tags/pwn/>pwn</a></li></ul><nav class=paginav><a class=prev href=https://quentinkhoo.github.io/posts/tisc-2022-level2-leaky-matrices/><span class=title>« Prev</span><br><span>TISC 2022 Level 2 - Leaky Matrices</span></a>
<a class=next href=https://quentinkhoo.github.io/posts/seetf-2022-smart-contract-dupersupersafe/><span class=title>Next »</span><br><span>SEETF 2022 Smart Contract DuperSuperSafe</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 1 - Slay The Dragon on twitter" href="https://twitter.com/intent/tweet/?text=TISC%202022%20Level%201%20-%20Slay%20The%20Dragon&url=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level1-slay-the-dragon%2f&hashtags=ctf%2ctisc-2022%2cpython%2cpwn"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 1 - Slay The Dragon on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level1-slay-the-dragon%2f&title=TISC%202022%20Level%201%20-%20Slay%20The%20Dragon&summary=TISC%202022%20Level%201%20-%20Slay%20The%20Dragon&source=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level1-slay-the-dragon%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 1 - Slay The Dragon on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level1-slay-the-dragon%2f&title=TISC%202022%20Level%201%20-%20Slay%20The%20Dragon"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 1 - Slay The Dragon on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level1-slay-the-dragon%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 1 - Slay The Dragon on whatsapp" href="https://api.whatsapp.com/send?text=TISC%202022%20Level%201%20-%20Slay%20The%20Dragon%20-%20https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level1-slay-the-dragon%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TISC 2022 Level 1 - Slay The Dragon on telegram" href="https://telegram.me/share/url?text=TISC%202022%20Level%201%20-%20Slay%20The%20Dragon&url=https%3a%2f%2fquentinkhoo.github.io%2fposts%2ftisc-2022-level1-slay-the-dragon%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://quentinkhoo.github.io>Quentin</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>